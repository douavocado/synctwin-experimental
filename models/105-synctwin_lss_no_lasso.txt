Running simulation with seed 100
loading data
Iteration 0
Pretrain
control post error tensor(1.3824)
treated post error tensor(0.7344)
pre error tensor(0.1641)
Iter 0100 | Total Loss 14.356524
Iter 0100 | Reconstruction Loss 13.134066
Iter 0100 | Supervised Loss 1.222459
control post error tensor(0.5724)
treated post error tensor(0.3911)
pre error tensor(0.0797)
Iter 0200 | Total Loss 5.138783
Iter 0200 | Reconstruction Loss 4.577359
Iter 0200 | Supervised Loss 0.561424
control post error tensor(0.4887)
treated post error tensor(0.3373)
pre error tensor(0.0732)
Iter 0300 | Total Loss 3.716205
Iter 0300 | Reconstruction Loss 3.229980
Iter 0300 | Supervised Loss 0.486225
control post error tensor(0.4216)
treated post error tensor(0.3717)
pre error tensor(0.0681)
Iter 0400 | Total Loss 2.975303
Iter 0400 | Reconstruction Loss 2.510569
Iter 0400 | Supervised Loss 0.464734
control post error tensor(0.4127)
treated post error tensor(0.3419)
pre error tensor(0.0624)
Iter 0500 | Total Loss 2.545758
Iter 0500 | Reconstruction Loss 2.106050
Iter 0500 | Supervised Loss 0.439709
control post error tensor(0.3813)
treated post error tensor(0.3431)
pre error tensor(0.0540)
Iter 0600 | Total Loss 2.131907
Iter 0600 | Reconstruction Loss 1.715748
Iter 0600 | Supervised Loss 0.416159
control post error tensor(0.3877)
treated post error tensor(0.3169)
pre error tensor(0.0446)
Iter 0700 | Total Loss 2.074501
Iter 0700 | Reconstruction Loss 1.677624
Iter 0700 | Supervised Loss 0.396877
control post error tensor(0.3667)
treated post error tensor(0.3750)
pre error tensor(0.0385)
Iter 0800 | Total Loss 1.885720
Iter 0800 | Reconstruction Loss 1.476389
Iter 0800 | Supervised Loss 0.409332
control post error tensor(0.3553)
treated post error tensor(0.3535)
pre error tensor(0.0301)
Iter 0900 | Total Loss 1.806981
Iter 0900 | Reconstruction Loss 1.422557
Iter 0900 | Supervised Loss 0.384424
control post error tensor(0.3647)
treated post error tensor(0.2970)
pre error tensor(0.0260)
Iter 1000 | Total Loss 1.657501
Iter 1000 | Reconstruction Loss 1.300660
Iter 1000 | Supervised Loss 0.356841
control post error tensor(0.3815)
treated post error tensor(0.2925)
pre error tensor(0.0213)
Iter 1100 | Total Loss 1.621899
Iter 1100 | Reconstruction Loss 1.263568
Iter 1100 | Supervised Loss 0.358330
control post error tensor(0.3527)
treated post error tensor(0.3253)
pre error tensor(0.0195)
Iter 1200 | Total Loss 1.575653
Iter 1200 | Reconstruction Loss 1.217132
Iter 1200 | Supervised Loss 0.358521
control post error tensor(0.3277)
treated post error tensor(0.3623)
pre error tensor(0.0192)
Iter 1300 | Total Loss 1.554149
Iter 1300 | Reconstruction Loss 1.189964
Iter 1300 | Supervised Loss 0.364185
control post error tensor(0.3506)
treated post error tensor(0.3011)
pre error tensor(0.0175)
Iter 1400 | Total Loss 1.473173
Iter 1400 | Reconstruction Loss 1.129827
Iter 1400 | Supervised Loss 0.343346
control post error tensor(0.3232)
treated post error tensor(0.3144)
pre error tensor(0.0172)
Iter 1500 | Total Loss 1.508373
Iter 1500 | Reconstruction Loss 1.172423
Iter 1500 | Supervised Loss 0.335950
control post error tensor(0.3247)
treated post error tensor(0.3359)
pre error tensor(0.0168)
Iter 1600 | Total Loss 1.435574
Iter 1600 | Reconstruction Loss 1.088443
Iter 1600 | Supervised Loss 0.347131
control post error tensor(0.3538)
treated post error tensor(0.2833)
pre error tensor(0.0168)
Iter 1700 | Total Loss 1.396134
Iter 1700 | Reconstruction Loss 1.060731
Iter 1700 | Supervised Loss 0.335404
control post error tensor(0.3138)
treated post error tensor(0.3098)
pre error tensor(0.0168)
Iter 1800 | Total Loss 1.406051
Iter 1800 | Reconstruction Loss 1.077401
Iter 1800 | Supervised Loss 0.328650
control post error tensor(0.3492)
treated post error tensor(0.2899)
pre error tensor(0.0177)
Iter 1900 | Total Loss 1.395112
Iter 1900 | Reconstruction Loss 1.057874
Iter 1900 | Supervised Loss 0.337238
control post error tensor(0.3076)
treated post error tensor(0.2724)
pre error tensor(0.0175)
Iter 2000 | Total Loss 1.335158
Iter 2000 | Reconstruction Loss 1.027686
Iter 2000 | Supervised Loss 0.307471
control post error tensor(0.3078)
treated post error tensor(0.2501)
pre error tensor(0.0186)
Iter 2100 | Total Loss 1.305292
Iter 2100 | Reconstruction Loss 1.007688
Iter 2100 | Supervised Loss 0.297603
control post error tensor(0.2937)
treated post error tensor(0.2237)
pre error tensor(0.0172)
Iter 2200 | Total Loss 1.228581
Iter 2200 | Reconstruction Loss 0.952652
Iter 2200 | Supervised Loss 0.275929
control post error tensor(0.3129)
treated post error tensor(0.1829)
pre error tensor(0.0163)
Iter 2300 | Total Loss 1.230728
Iter 2300 | Reconstruction Loss 0.966557
Iter 2300 | Supervised Loss 0.264171
control post error tensor(0.3038)
treated post error tensor(0.2051)
pre error tensor(0.0154)
Iter 2400 | Total Loss 1.175218
Iter 2400 | Reconstruction Loss 0.905357
Iter 2400 | Supervised Loss 0.269861
control post error tensor(0.2921)
treated post error tensor(0.1836)
pre error tensor(0.0156)
Iter 2500 | Total Loss 1.136620
Iter 2500 | Reconstruction Loss 0.883234
Iter 2500 | Supervised Loss 0.253386
control post error tensor(0.2646)
treated post error tensor(0.1601)
pre error tensor(0.0152)
Iter 2600 | Total Loss 1.092191
Iter 2600 | Reconstruction Loss 0.864655
Iter 2600 | Supervised Loss 0.227536
control post error tensor(0.2694)
treated post error tensor(0.1876)
pre error tensor(0.0146)
Iter 2700 | Total Loss 1.121657
Iter 2700 | Reconstruction Loss 0.878580
Iter 2700 | Supervised Loss 0.243077
control post error tensor(0.2566)
treated post error tensor(0.2027)
pre error tensor(0.0148)
Iter 2800 | Total Loss 1.108739
Iter 2800 | Reconstruction Loss 0.864294
Iter 2800 | Supervised Loss 0.244446
control post error tensor(0.2394)
treated post error tensor(0.1538)
pre error tensor(0.0149)
Iter 2900 | Total Loss 1.039776
Iter 2900 | Reconstruction Loss 0.828282
Iter 2900 | Supervised Loss 0.211494
control post error tensor(0.2368)
treated post error tensor(0.1565)
pre error tensor(0.0145)
Iter 3000 | Total Loss 1.010294
Iter 3000 | Reconstruction Loss 0.799121
Iter 3000 | Supervised Loss 0.211173
control post error tensor(0.2397)
treated post error tensor(0.1487)
pre error tensor(0.0153)
Iter 3100 | Total Loss 0.991597
Iter 3100 | Reconstruction Loss 0.782033
Iter 3100 | Supervised Loss 0.209565
control post error tensor(0.2619)
treated post error tensor(0.1545)
pre error tensor(0.0156)
Iter 3200 | Total Loss 1.003415
Iter 3200 | Reconstruction Loss 0.779638
Iter 3200 | Supervised Loss 0.223777
control post error tensor(0.2450)
treated post error tensor(0.1464)
pre error tensor(0.0146)
Iter 3300 | Total Loss 0.995389
Iter 3300 | Reconstruction Loss 0.785098
Iter 3300 | Supervised Loss 0.210291
control post error tensor(0.2433)
treated post error tensor(0.1306)
pre error tensor(0.0147)
Iter 3400 | Total Loss 0.989957
Iter 3400 | Reconstruction Loss 0.788299
Iter 3400 | Supervised Loss 0.201658
control post error tensor(0.2465)
treated post error tensor(0.1473)
pre error tensor(0.0149)
Iter 3500 | Total Loss 0.980655
Iter 3500 | Reconstruction Loss 0.768794
Iter 3500 | Supervised Loss 0.211861
control post error tensor(0.2425)
treated post error tensor(0.1388)
pre error tensor(0.0145)
Iter 3600 | Total Loss 0.976564
Iter 3600 | Reconstruction Loss 0.771505
Iter 3600 | Supervised Loss 0.205059
control post error tensor(0.2516)
treated post error tensor(0.1536)
pre error tensor(0.0149)
Iter 3700 | Total Loss 1.015577
Iter 3700 | Reconstruction Loss 0.798062
Iter 3700 | Supervised Loss 0.217515
control post error tensor(0.2682)
treated post error tensor(0.1340)
pre error tensor(0.0142)
Iter 3800 | Total Loss 0.955012
Iter 3800 | Reconstruction Loss 0.739740
Iter 3800 | Supervised Loss 0.215271
control post error tensor(0.2363)
treated post error tensor(0.1434)
pre error tensor(0.0149)
Iter 3900 | Total Loss 0.974677
Iter 3900 | Reconstruction Loss 0.769879
Iter 3900 | Supervised Loss 0.204798
control post error tensor(0.2511)
treated post error tensor(0.1376)
pre error tensor(0.0144)
Iter 4000 | Total Loss 0.947597
Iter 4000 | Reconstruction Loss 0.738811
Iter 4000 | Supervised Loss 0.208785
control post error tensor(0.2597)
treated post error tensor(0.1336)
pre error tensor(0.0144)
Iter 4100 | Total Loss 0.943127
Iter 4100 | Reconstruction Loss 0.732014
Iter 4100 | Supervised Loss 0.211113
control post error tensor(0.2599)
treated post error tensor(0.1422)
pre error tensor(0.0142)
Iter 4200 | Total Loss 0.962021
Iter 4200 | Reconstruction Loss 0.746762
Iter 4200 | Supervised Loss 0.215259
control post error tensor(0.2372)
treated post error tensor(0.1656)
pre error tensor(0.0141)
Iter 4300 | Total Loss 0.949665
Iter 4300 | Reconstruction Loss 0.734156
Iter 4300 | Supervised Loss 0.215509
control post error tensor(0.2641)
treated post error tensor(0.1254)
pre error tensor(0.0142)
Iter 4400 | Total Loss 0.939844
Iter 4400 | Reconstruction Loss 0.730897
Iter 4400 | Supervised Loss 0.208947
control post error tensor(0.2342)
treated post error tensor(0.1561)
pre error tensor(0.0141)
Iter 4500 | Total Loss 0.951202
Iter 4500 | Reconstruction Loss 0.741974
Iter 4500 | Supervised Loss 0.209228
control post error tensor(0.2393)
treated post error tensor(0.1535)
pre error tensor(0.0142)
Iter 4600 | Total Loss 0.917471
Iter 4600 | Reconstruction Loss 0.706882
Iter 4600 | Supervised Loss 0.210589
control post error tensor(0.2400)
treated post error tensor(0.1441)
pre error tensor(0.0139)
Iter 4700 | Total Loss 0.917558
Iter 4700 | Reconstruction Loss 0.711579
Iter 4700 | Supervised Loss 0.205980
control post error tensor(0.2503)
treated post error tensor(0.1131)
pre error tensor(0.0141)
Iter 4800 | Total Loss 0.940647
Iter 4800 | Reconstruction Loss 0.744926
Iter 4800 | Supervised Loss 0.195721
control post error tensor(0.2429)
treated post error tensor(0.1748)
pre error tensor(0.0141)
Iter 4900 | Total Loss 0.932432
Iter 4900 | Reconstruction Loss 0.709489
Iter 4900 | Supervised Loss 0.222943
control post error tensor(0.2415)
treated post error tensor(0.1410)
pre error tensor(0.0142)
Iter 5000 | Total Loss 0.928122
Iter 5000 | Reconstruction Loss 0.722624
Iter 5000 | Supervised Loss 0.205498
Eval
Matching on validation set
Iter 1000 | Total Loss 0.081259
Iter 2000 | Total Loss 0.071080
Iter 3000 | Total Loss 0.065052
Iter 4000 | Total Loss 0.053458
Iter 5000 | Total Loss 0.043846
Iter 6000 | Total Loss 0.038390
Iter 7000 | Total Loss 0.031649
Iter 8000 | Total Loss 0.026480
Iter 9000 | Total Loss 0.021490
Iter 10000 | Total Loss 0.019226
Iter 11000 | Total Loss 0.014338
Iter 12000 | Total Loss 0.012329
Iter 13000 | Total Loss 0.012448
Iter 14000 | Total Loss 0.009351
Iter 15000 | Total Loss 0.008079
Iter 16000 | Total Loss 0.007589
Iter 17000 | Total Loss 0.006742
Iter 18000 | Total Loss 0.005783
Iter 19000 | Total Loss 0.006766
Iter 20000 | Total Loss 0.005915
--- Training done in 412.086923122406 seconds ---
Control Y MAE: 0.143950417637825
Testing
Iteration 0
Iter 1000 | Total Loss 0.084482
Iter 2000 | Total Loss 0.072732
Iter 3000 | Total Loss 0.063962
Iter 4000 | Total Loss 0.052845
Iter 5000 | Total Loss 0.044366
Iter 6000 | Total Loss 0.038524
Iter 7000 | Total Loss 0.033943
Iter 8000 | Total Loss 0.029193
Iter 9000 | Total Loss 0.024023
Iter 10000 | Total Loss 0.018504
Iter 11000 | Total Loss 0.015657
Iter 12000 | Total Loss 0.013297
Iter 13000 | Total Loss 0.009894
Iter 14000 | Total Loss 0.010736
Iter 15000 | Total Loss 0.009400
Iter 16000 | Total Loss 0.007802
Iter 17000 | Total Loss 0.007001
Iter 18000 | Total Loss 0.007393
Iter 19000 | Total Loss 0.007522
Iter 20000 | Total Loss 0.006055
Best model: 0
Treatment effect MAE: (0.20007784314007585, 0.012914122814709947)
Control Y MAE: 0.14179334044456482
Gini 0.491 (0.018)
Ent 1.232 (0.047)
N Matched 2.645 (0.086)
MIS 0.670 (0.033)
Wrong proba 0.630 (0.024)
Average Training Time: 412.086923122406
Std Training Time: 0.0
